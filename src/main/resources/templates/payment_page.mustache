<!DOCTYPE html>
<html lang="en">

<head>
  <script type="text/javascript" src="https://code.jquery.com/jquery-1.12.4.min.js" ></script>
  <script type="text/javascript" src="https://cdn.iamport.kr/js/iamport.payment-1.1.5.js"></script>
  <meta charset="UTF-8">
  <title>Shoe-auction</title>

</head>
<body>
<button id="uuid" value="{{customerId}}">결제수단등록</button>
</body>
</html>

<script>
  $('#uuid').click(function () {
  IMP.init('imp02405334');

  var customer_uid = document.getElementById("uuid").value;

  IMP.request_pay({
    pay_method : 'card', // 'card'만 지원됩니다.
    merchant_uid : 'merchant_' + new Date().getTime(),
    name : '최초인증결제',
    amount : 0,
    customer_uid : customer_uid + 'iamport', //customer_uid , 빌링 키와 1:1 관계를 갖는 KEY
    buyer_email : 'rlgur405@gmail.com',
    buyer_name : 'shoe-auction',
    buyer_tel : '010-2018-0103'
  }, function(rsp) {
    if ( rsp.success ) {
      alert('빌링키 발급 성공');
      console.log(rsp);
      $.ajax({
        type : "POST",
        url : "/payment",
        dataType :JSON,
        data : {
          billingKey : rsp.customer_uid,
          cardName : rsp.card_name
        }
      });

    } else {
      alert('빌링키 발급 실패');
    }
  });
});
</script>